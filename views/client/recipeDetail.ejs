<head>
  <link rel="stylesheet" href="/css/clients/stars.css" />
  <link rel="stylesheet" href="/css/partials/globalCSS.css" />

  <style>
    ::-webkit-scrollbar {
      width: 0;
    }

    ::-webkit-scrollbar-track {
      width: 0;
    }

    header a[href] {
      color: #707070;
    }
  </style>
</head>
<div class="container-fluid m-0" style="background: #f5f5f5">
  <div class="container py-4">
    <div class="row breadcumb px-md-3 py-2" style="background: white; padding: 0 8px;">
      <div class="col p-0">
        <a href="/" class="text-decoration-none"> &#127968; Home </a>
        <span class="path-arrow"> > </span> <%= recipe.name %>
      </div>
    </div>
    <div
      class="row title d-flex justify-content-center align-items-center"
      style="margin-bottom: 130px; padding-top: 30px"
    >
      <div class="col-md-10 col-12 p-0">
        <h1><%= recipe.name %></h1>
        <p><%= recipe.description %></p>
      </div>
      <div
        class="col-md-2 col-12 px-2 position-relative cuisine p-1"
        style="
          background: #e7a046;
          text-align: right;
          clip-path: polygon(
            100% 0,
            100% 50%,
            100% 100%,
            0% 100%,
            25% 50%,
            0% 0%
          );
        "
      >
        <h4><%= recipe.cuisine.name %></h4>
        <h5>Cuisine</h5>
        <div
          class="container position-absolute bottom-0 start-0 h-100"
          style="
            width: 100px;
            clip-path: polygon(
              30% 100%,
              60% 100%,
              70% 75%,
              100% 50%,
              70% 25%,
              60% 0,
              30% 0,
              70% 25%,
              75% 50%,
              70% 75%,
              30% 100%
            );
            background: #f1e4c388;
          "
        ></div>
      </div>
    </div>
    <div class="row content shadow" style="background: white">
      <div class="row media px-md-5 m-0" style="height: 550px">
        <div class="col p-0 text-center position-relative">
          <img
            src="<%= recipe.image %>"
            class="center w-100 position-absolute bottom-0 start-0 border border-dark"
            alt="<%= recipe.name %> image"
            style="object-fit: cover; height: 600px; transform: translateY(-8%)"
          />
        </div>
      </div>
      <div class="row information px-md-5 m-0">
        <div class="row ingredients m-0 p-0">
          <div class="col-md-9 col-12 m-0">
            <div class="row cook-time">
              <div class="row m-0 p-0">
                <div
                  class="col col-md-6"
                  style="
                    background: orange;
                    position: relative;
                    min-height: 20px;
                  "
                >
                  <img
                    src="/images/chef-hat.png"
                    class="position-absolute end-0 top-0"
                    alt="Icon"
                    style="
                      width: 70px;
                      transform: translate(-40%, -38%) rotate(23.55deg);
                    "
                  />
                </div>
              </div>
              <div class="row m-0 p-0">
                <div
                  class="col col-md-6 time m-0 p-2 rounded-bottom-3"
                  style="background: #f1e4c3"
                >
                  <h5>Cook time:</h5>
                  <p class="m-0"><%= recipe.time %></p>
                </div>
              </div>
            </div>
            <div class="row ingredient-list mt-4">
              <div class="col">
                <h2>Ingredients</h2>

                <ul>
                  <% recipe.ingredients.forEach(eachIngredient =>{ %>
                  <li>
                    <%= eachIngredient.ingredient.name %> (<%=
                    eachIngredient.quantity %>)
                  </li>
                  <% }) %>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-12 p-0">
            <div class="container fact rounded-4 p-4" style="background-color: rgba(255,209,125,0.7);">
              <div class="row fact-heading text-center">
                <h5>Did you know?</h5>
              </div>
              <div class="row fact-image text-center m-3">
                <div class="col">
                  <img
                    src="/images/planet-earth.png"
                    alt="fact image"
                    class="w-50 center"
                    style="object-fit: cover"
                  />
                </div>
              </div>
              <div
                class="row fact-detail text-center"
                style="word-spacing: -1px"
              >
              Just one-quarter of the food we currently waste could be enough to feed all undernourished people in the world
              </div>
            </div>
          </div>
        </div>

        <div class="row instruction-heading pt-4">
          <h2>Cooking instruction:</h2>
        </div>
        <div
          class="row instruction-body position-relative m-0 p-0 overflow-hidden"
          style="height: 200px"
        >
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Earum
          assumenda reiciendis bland Lorem ipsum dolor sit amet consectetur
          adipisicing elit. Earum assumenda reiciendis blanditiis, provident
          tempora alias omnis ipsum ipsam nihil odit architecto fugit minus
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Lorem ipsum
          dolor sit amet consectetur adipisicing elit. Earum assumenda
          reiciendis bland Lorem ipsum dolor sit amet consectetur adipisicing
          elit. Earum assumenda reiciendis blanditiis, provident tempora alias
          omnis ipsum ipsam nihil odit architecto fugit minus Lorem ipsum dolor
          sit amet consectetur adipisicing elit. Lorem ipsum dolor sit amet
          consectetur adipisicing elit. Earum assumenda reiciendis bland Lorem
          ipsum dolor sit amet consectetur adipisicing elit. Earum assumenda
          reiciendis blanditiis, provident tempora alias omnis ipsum ipsam nihil
          odit architecto fugit minus Lorem ipsum dolor sit amet consectetur
          adipisicing elit. Lorem ipsum dolor sit amet consectetur adipisicing
          elit. Earum assumenda reiciendis bland Lorem ipsum dolor sit amet
          consectetur adipisicing elit. Earum assumenda reiciendis blanditiis,
          provident tempora alias omnis ipsum ipsam nihil odit architecto fugit
          minus Lorem ipsum dolor sit amet consectetur adipisicing elit. Lorem
          ipsum dolor sit amet consectetur adipisicing elit. Earum assumenda
          reiciendis bland Lorem ipsum dolor sit amet consectetur adipisicing
          elit. Earum assumenda reiciendis blanditiis, provident tempora alias
          omnis ipsum ipsam nihil odit architecto fugit minus Lorem ipsum dolor
          sit amet consectetur adipisicing elit.

          <div
            class="col position-absolute h-100 d-flex align-items-center justify-content-center"
            style="
              background: linear-gradient(180deg, transparent, white);
              backdrop-filter: blur(2px);
            "
          >
            <a
              href="<%= recipe.url %>"
              target="_blank"
              class="text-decoration-none text-white rounded-3 p-2 fs-5"
              style="background: #e7aa46; border: none"
            >
              View full instruction
            </a>
          </div>
        </div>

        <div class="row access-link text-center m-0 my-5 p-0">
          <div class="col">
            <h3>Love to know more?</h3>
          </div>
          <div class="row position-relative m-0 p-0" style="height: 100px">
            <img
              src="/images/curve-arrow.png"
              class="position-absolute start-50"
              alt="arrow"
              style="
                transform: rotate(140deg) translate(-30%, -20%);
                width: 150px;
              "
            />
          </div>
          <div
            class="row m-0 p-0 d-flex align-items-center justify-content-center"
          >
            <p class="fs-5">View the full recipe at:</p>
            <a
              href="<%= recipe.url %>"
              class="w-md-100 w-100 text-wrap"
              target="_blank"
              style="
              overflow-wrap: break-word;
              text-decoration: underline;
              color: rgb(13, 110, 253);
              "
            >
              <%= recipe.url %>
            </a>
          </div>
        </div>
        <hr />
        <div class="row p-0 m-0">
          <p>
            Filed under:
            <button
              type="button"
              class="px-2 py-1 border-0 text-white"
              style="background: #e7aa46"
            >
              <%= recipe.cuisine.name %>
            </button>
            <button
              type="button"
              class="px-2 py-1 border-0 text-white"
              style="background: #e7aa46"
            >
              <%= recipe.time %>
            </button>
          </p>
        </div>
      </div>
    </div>
    <div class="row comment-section mt-4 py-4" style="background: white">
      <% if(user){ %>
      <div class="row comment-body p-0 m-0 mb-4">
        <div class="col">
          <div class="section d-flex align-items-center">
            <% if(user.avatar){ %>
              <img
                 class="profile-picture"
                 loading="eager"   
                 src="<%= user.avatar %>"
                 alt="profile picture"
                 style="
                 border-radius: 50%;
                 width: 50px;
                 height: 50px;
                 margin-right: 20px;
               "
              />
              <% } else { %>
              <img
                 class="profile-picture"
                 loading="eager"
                 src="/images/user.png"
                 alt="profile picture"
                 style="
                 border-radius: 50%;
                 width: 50px;
                 height: 50px;
                 margin-right: 20px;
               "
              />
              <% } %>
            <h6><%= user.username %></h6>
          </div>
          <form
            action="/recipes/<%= recipe.slug %>/add-review"
            method="post"
          >
            <fieldset class="rating">
              <input
                type="radio"
                id="5-stars"
                name="rating"
                value="5"
                v-model="ratings"
                hidden
              />
              <label for="5-stars" class="star pr-4">
                <i class="ri-heart-3-fill stars" ></i>
              </label>
              <input
                type="radio"
                id="4-stars"
                name="rating"
                value="4"
                v-model="ratings"
              />
              <label for="4-stars" class="star">
                <i class="ri-heart-3-fill stars" ></i>
              </label>
              <input
                type="radio"
                id="3-stars"
                name="rating"
                value="3"
                v-model="ratings"
              />
              <label for="3-stars" class="star">
                <i class="ri-heart-3-fill stars" ></i>
              </label>
              <input
                type="radio"
                id="2-stars"
                name="rating"
                value="2"
                v-model="ratings"
              />
              <label for="2-stars" class="star">
                <i class="ri-heart-3-fill stars" ></i>
              </label>
              <input
                type="radio"
                id="1-star"
                name="rating"
                value="1"
                v-model="ratings"
              />
              <label for="1-star" class="star">
                <i class="ri-heart-3-fill stars" ></i>
              </label>
            </fieldset>
            <textarea
              name="review"
              id="review"
              rows="6"
              class="w-100 rounded-2 p-2"
              placeholder="Tell us what you think about this recipe..."
              style="resize: none"
            ></textarea>
            <button type="submit" class="btn btn-primary mt-2">Post</button>
          </form>
        </div>
      </div>
      <% } %>
      <div class="row comment-list px-0 m-0">
        <div class="col">
          <div class="comment-list-header" id="comments">
            <% if(recipe.reviews.length <2){ %>
            <h3>Comment (<%= recipe.reviews.length %>)</h3>
            <% } else { %>
            <h3>Comments (<%= recipe.reviews.length %>)</h3>
            <% } %>
          </div>
          <% if(recipe.reviews.length > 0){ %> <%
          recipe.reviews.forEach((review) => { %>
          <div class="section mt-3 d-flex align-items-center">
            <% if(review.user && review.user.avatar){ %>
            <img
              src="<%= review.user.avatar %>"
              alt="User image"
              style="
                border-radius: 50%;
                width: 50px;
                height: 50px;
                margin: 0 20px 10px 0;
                border: solid 0.75px #a5a5a5;
              "
            />
            <% } else { %>
            <img
              src="/images/default-avatar.png"
              alt="User image"
              style="
                border-radius: 50%;
                width: 50px;
                height: 50px;
                margin: 0 20px 10px 0;
                border: solid 1px #a5a5a5;
              "
            />
            <% } %> <% if(review.user && review.user.username) { %>
            <h6><%= review.user.username %></h6>
            <% } %>
          </div>
          <div
            class="comment border border-dark p-1 rounded-3 bg-white overflow-auto position-relative"
            style="height: 125px"
          >
            <div class="user-rating">
              <!-- Dynamically generate star ratings based on the review's rating -->
              <% for (let i=1; i <=5; i++) { %> <% if (i <= review.rating){ %>
                <i class="ri-heart-3-fill stars" style="color: #980201; font-size: x-large;"></i>
              <% } else { %>
                <i class="ri-heart-3-fill stars" style="color: #eddfdf; font-size: x-large;"></i>
              <% } %> <% } %>
            </div>
            <p><%= review.review %></p>
          </div>
          <% }) %> <% } %>
        </div>
      </div>
    </div>
  </div>
</div>
